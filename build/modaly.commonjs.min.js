Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;class Modaly{constructor(t,e={}){this.el=t,this.options=e}block(t){this.modal.modal.dataset.block=t?"true":"false"}close(){this._hide(this.modal),this._hide(this.overlay),this.modal.dispatchEvent(new CustomEvent("modaly:closed"))}defaults(){return{attribute:"href",block:!1,closeButton:!0,closeOverlay:!0,closeTarget:"[data-modal-close]",esc:!0,overlay:.5,prevent:!0,speed:200,top:void 0,visible:!1}}init(){return this.opt={...this.defaults(),...this.options},this.overlay=this._overlay(),this.modal=this._modal(),this.closeButton=this._closeButton(),this._bind(),this.modal.dataset.block=this.opt.block,this.modal.dataset.modaly=!0,this}open(){var t;void 0!==this.opt.top&&(t="number"==typeof this.opt.top||!this.opt.top.includes("px")&&!this.opt.top.includes("%")?"px":"",this.modal.style.top=this.opt.top+t),this._show(this.modal,1),this._show(this.overlay,this.opt.overlay),this.modal.dispatchEvent(new CustomEvent("modaly:opened"))}_bind(){this.el.querySelectorAll(this.opt.closeTarget).forEach(t=>{t.addEventListener("click",()=>this.close())}),this.opt.closeOverlay&&this.overlay.addEventListener("click",()=>this.close()),this.el.addEventListener("click",t=>{this.opt.prevent&&(t.preventDefault(),this.el.checked=!this.el.checked),this.opt.anchorless?t.stopPropagation():"false"===this.el.dataset.block&&this.open()}),this.opt.esc&&document.addEventListener("keyup",t=>{"Escape"===t.key&&this.close()})}_closeButton(){var t=this.modal.querySelector(this.opt.closeTarget);return this.opt.closeButton||(t.style.display="none"),t}_hide(t){t.style.transition=`opacity ${this.opt.speed}ms`,t.style.opacity=0,t.style.display="none"}_modal(){var t=document.querySelector(this.el.getAttribute(this.opt.attribute))||this.el;return this.opt.visible||t.classList.add("modaly"),this.opt.anchorless=t===this.el,t}_overlay(){let t=document.getElementById("modaly__overlay");return t||((t=document.createElement("div")).id="modaly__overlay",document.body.appendChild(t)),t}_show(t,e){t===this.modal&&t.classList.add("modaly--visible"),t.style.transition=`opacity ${this.opt.speed}ms`,t.style.display="block",t.style.opacity=e}}var _default=exports.default=Modaly;